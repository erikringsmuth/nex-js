<h2>Tutorial</h2>

<p>This will walk you through setting up a working web app. It demonstrates the use of <a href="http://bower.io/">Bower</a>, <a href="http://requirejs.org/">RequireJS</a>, the <a href="https://github.com/erikringsmuth/requirejs-router">RequireJS router</a>, <a href="#/">Nex views</a>, and <a href="http://getbootstrap.com/">Bootstrap</a>.</p>

<p class="spacer">If you're running Windows you will need to download and install <a href="http://nodejs.org/">node.js</a>. This comes pre-installed on new Macs.</p>

<p class="spacer">Directory layout - The site should be structured so that each page and widget gets its own folder under <code>/js</code>. This keeps related files together. Start by creating a folder that will contain all of your site's files. We will create all of these files by the end of the tutorial.</p>

<pre class="prettyprint"><code>├── index.html
├── bower.json
├── bower_components/
│   └── // external dependencies, this folder is automatically generated
└── js/
    ├── main.js
    ├── layout/
    │   ├── layoutView.js
    │   └── layoutTemplate.html
    ├── home/
    │   ├── homeView.js
    │   └── homeTemplate.js
    └── // other widets and views</code></pre>

<p class="spacer">Create a <code>bower.json</code> file in the root directory of your project. This defines all of our dependencies. We will use <a href="http://bower.io/">Bower</a> to automatically install them.</p>

<pre class="prettyprint"><code>{
  "name": "my-awesome-app",
  "dependencies": {
    "requirejs": "latest",
    "requirejs-text": "latest",
    "requirejs-router": "latest",
    "nex-js": "latest",
    "handlebars": "latest",
    "bootstrap": "latest"
  }
}</code></pre>

<p class="spacer">Open a command prompt or terminal and switch to your site's directory.</p>

<p>Run <code>npm install -g bower</code> to install <a href="http://bower.io/">Bower</a>. The <code>-g</code> flag tells it to install Bower globally.</p>

<p>Run <code>bower install</code>. This will download all of the dependencies to <code>/bower_components</code>.</p>

<p class="spacer">Create <code class="lang-htm">/index.html</code> - This is loads RequireJS and the Bootstrap CSS.</p>

<pre class="prettyprint"><code>&lt;!doctype html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;My Awesome App!&lt;/title&gt;
    &lt;link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.css"&gt;
    &lt;script data-main="js/main" src="bower_components/requirejs/require.js"&gt;&lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;!-- main.js bootstraps the javascript app and inserts it here --&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>

<p class="spacer">Create <code class="pln">/js/main.js</code> - This is the Javascript entry point to the app. It configures RequireJS and defines all of the routes.</p>

<pre class="prettyprint"><code>define([], function() {
  'use strict';

  // Configure require.js paths and shims
  require.config({
    baseUrl: '..', // main.js is in `/js` but we want the baseUrl to be `/`
    paths: {
      'text': 'bower_components/requirejs-text/text',
      'router': 'bower_components/requirejs-router/router',
      'nex': 'bower_components/nex-js/nex',
      'handlebars': 'bower_components/handlebars/handlebars'
    },
    shim: {
      'handlebars': { exports: 'Handlebars' }
    }
  });

  // Load the router
  require(['router'], function(router) {
    // Configure the router
    router.config({
      // Add all of your routes here
      routes: {
        home: {path: '/', moduleId: 'js/home/homeView'},
        example: {path: '/examples', moduleId: 'js/examples/examplesView'},
        notFound: {path: '*', moduleId: 'js/notFound/notFoundView'}
      },

      // When a route loads, render the view and attach it to the document
      routeLoadedCallback: function routeLoadedCallback(View, routeArguments) {
        var body = document.querySelector('body');
        body.innerHTML = '';
        body.appendChild(new View(routeArguments).outerEl);
      }
    });

    // Trigger the initial page load
    router.loadCurrentRoute();
  });
});</code></pre>

<p class="spacer">Create <code class="pln">/js/layout/layoutTemplate.html</code> - This is your app's layout HTML. A layout contains common elements like the header, footer, etc. This will get rendered with every view.</p>

<pre class="prettyprint"><code>&lt;header class="navbar navbar-default"&gt;
  &lt;div class="container"&gt;
    &lt;a href="#/" class="navbar-brand"&gt;{nex.js}&lt;/a&gt;
    &lt;ul class="nav navbar-nav"&gt;
      &lt;li \{{#if model.routes.home.active}}class="active"\{{/if}}&gt;&lt;a href="#/"&gt;Home&lt;/a&gt;&lt;/li&gt;
      &lt;li \{{#if model.routes.examples.active}}class="active"\{{/if}}&gt;&lt;a href="#/examples"&gt;Examples&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/div&gt;
&lt;/header&gt;
&lt;main id="content" class="container"&gt;
&lt;/main&gt;</code></pre>

<p class="spacer">Create <code class="pln">/js/layout/layoutView.js</code> - This is the nex-js layout view. You can see the <code>contentPlaceholderId</code> points to the layout HTML <code>&lt;main id="content" class="container"&gt;</code>. This is how your view's are attached to the layout.</p>

<pre class="prettyprint"><code>define([
  'nex',
  'handlebars',
  'text!./layoutTemplate.html',
  'router'
], function(Nex, Handlebars, layoutTemplate, router) {
  'use strict';

  return Nex.View.extend({
    template: Handlebars.compile(layoutTemplate),
    model: {routes: router.routes},
    contentPlaceholderId: 'content'
  });
});</code></pre>

<p class="spacer">Create <code class="pln">/js/home/homeView.js</code> - This is the nex-js view for the home route <code>/</code>.</p>

<pre class="prettyprint"><code>define([
  'nex',
  'handlebars',
  'text!./homeTemplate.html',
  'js/layout/layoutView'
], function(Nex, Handlebars, homeTemplate, LayoutView) {
  'use strict';

  return Nex.View.extend({
    template: Handlebars.compile(homeTemplate),
    layoutView: LayoutView
  });
});</code></pre>

<p class="spacer">Create <code class="pln">/js/home/homeTemplate.html</code> - This is the HTML template for the home view <code>/</code>.</p>

<pre class="prettyprint"><code>&lt;h1&gt;Hello Nex!&lt;/h1&gt;</code></pre>

<p class="spacer">That's all of the files! Now we need to set up a server to host everything. Run <code>npm install http-server -g</code> to install a node.js HTTP server. Run <code>http-server</code> to start the server. It will host your files at <code>http://localhost:8080/</code>. Open a browser and go to your site at <code>http://localhost:8080/</code>. You just made your first app!</p> 

<h2 class="spacer">Review</h2>

<p>Execution order</p> 

<ul>
  <li><code>index.html</code> loads <code>require.js</code></li>
  <li><code>require.js</code> looks at the <code>data-main</code> attribute and loads <code>main.js</code></li>
  <li><code>main.js</code> configures <code>require.js</code> and the <code>requirejs-router</code></li>
  <li>The <code>requirejs-router</code> loads the current route <code>/</code> which is <code>homeView.js</code></li>
  <li><code>homeView.js</code> uses <code>layoutView.js</code> as it's layout</li>
  <li>The home view and layout are rendered and attached to the document in the router's <code>routeLoadedCallback()</code></li>
</ul>

<p class="spacer">The resulting HTML has the home view rendered with the layout.</p>

<pre class="prettyprint"><code>&lt;!doctype html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;My Awesome App!&lt;/title&gt;
    &lt;link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.css"&gt;
    &lt;script data-main="js/main" src="bower_components/requirejs/require.js"&gt;&lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div&gt; &lt;!-- layoutView.el, homeView.outerEl --&gt;
      &lt;header class="navbar navbar-default"&gt;
        &lt;div class="container"&gt;
          &lt;a href="#/" class="navbar-brand"&gt;{nex.js}&lt;/a&gt;
          &lt;ul class="nav navbar-nav"&gt;
            &lt;li class="active"&gt;&lt;a href="#/"&gt;Home&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a href="#/examples"&gt;Examples&lt;/a&gt;&lt;/li&gt;
          &lt;/ul&gt;
        &lt;/div&gt;
      &lt;/header&gt;
      &lt;main id="content" class="container"&gt;
        &lt;div&gt; &lt;!-- homeView.el --&gt;
          &lt;h1&gt;Hello Nex!&lt;/h1&gt;
        &lt;/div&gt;
      &lt;/main&gt;
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>

<p class="spacer">Keep coding! Make it awesome! Check out the <a href="#/api">API</a> for more ideas.</p>

<h2 class="spacer">Full site example</h2>

<p>This site is built on <a href="http://requirejs.org/">RequireJS</a>, <a href="https://github.com/erikringsmuth/nex-js">nex-js</a>, and the <a href="https://github.com/erikringsmuth/requirejs-router">RequireJS Router</a>. The site's source is available in the <a href="https://github.com/erikringsmuth/nex-js/tree/gh-pages">gh-pages branch</a> of nex-js. This is a great example of a full site setup. Dependencies are installed using <a href="http://bower.io/">Bower</a>.</p>
